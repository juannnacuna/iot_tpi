<!DOCTYPE html>
<html>
  <head>
    <title>ESP32 Web Server</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="data:,">
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>
    <h1>ESP32 Web Server</h1>
    <h2>Nodo 37</h2>

    <table class="table">
      <tr>
        <td>
          <h2>Unidad 37A</h2>
          <p>Distancia (cm): <span id="distanceSensorA"></span></p>
          <p>Estado: <strong id="stateUnitA">%STATE_UNIT_A%</strong></p>
          <p>
            <a href="ocuparUnitA"><button class="button">OCUPAR</button></a>
            <a href="liberarUnitA"><button class="button button2">LIBERAR</button></a>
          </p>
        </td>
        <td>
          <h2>Unidad 37B</h2>
          <p>Distancia (cm): <span id="distanceSensorB"></span></p>
          <p>Estado: <strong id="stateUnitB">%STATE_UNIT_B%</strong></p>
          <p>
            <a href="ocuparUnitB"><button class="button">OCUPAR</button></a>
            <a href="liberarUnitB"><button class="button button2">LIBERAR</button></a>
          </p>
        </td>
      </tr>
      <tr>
        <td>
          <h2>Unidad 37C</h2>
          <p>Distancia (cm): <span id="distanceSensorC"></span></p>
          <p>Estado: <strong id="stateUnitC">%STATE_UNIT_C%</strong></p>
          <p>
            <a href="ocuparUnitC"><button class="button">OCUPAR</button></a>
            <a href="liberarUnitC"><button class="button button2">LIBERAR</button></a>
          </p>
        </td>
        <td>
          <h2>Unidad 37D</h2>
          <p>Distancia (cm): <span id="distanceSensorD"></span></p>
          <p>Estado: <strong id="stateUnitD">%STATE_UNIT_D%</strong></p>
          <p>
            <a href="ocuparUnitD"><button class="button">OCUPAR</button></a>
            <a href="liberarUnitD"><button class="button button2">LIBERAR</button></a>
          </p>
        </td>
      </tr>
    </table>

    <br>

    <div class="info">
      <p>La informacion se actualiza cada 5 segundos.</p>
      <p>Cambios de estados:</p>
      <p>Ocupar unidad libre o potencialmente libre -> Unidad ocupada</p>
      <p>Liberar unidad ocupada -> Unidad potencialmente libre</p>
      <p>Liberar unidad potencialmente libre -> Unidad libre</p>
    </div>

    <!-- Script para actualizar informacion cada 5 segundos -->
    <script>
      setInterval(function() {
        fetch('/distanceSensorA')
          .then(response => response.text())
          .then(data => {
            document.getElementById("distanceSensorA").innerHTML = data;
          });
        fetch('/stateUnitA')
          .then(response => response.text())
          .then(data => {
            document.getElementById("stateUnitA").innerHTML = data;
          });
        fetch('/distanceSensorB')
          .then(response => response.text())
          .then(data => {
            document.getElementById("distanceSensorB").innerHTML = data;
          });
        fetch('/stateUnitB')
          .then(response => response.text())
          .then(data => {
            document.getElementById("stateUnitB").innerHTML = data;
          });
        fetch('/distanceSensorC')
          .then(response => response.text())
          .then(data => {
            document.getElementById("distanceSensorC").innerHTML = data;
          });
        fetch('/stateUnitC')
          .then(response => response.text())
          .then(data => {
            document.getElementById("stateUnitC").innerHTML = data;
          });
        fetch('/distanceSensorD')
          .then(response => response.text())
          .then(data => {
            document.getElementById("distanceSensorD").innerHTML = data;
          });
        fetch('/stateUnitD')
          .then(response => response.text())
          .then(data => {
            document.getElementById("stateUnitD").innerHTML = data;
          });
      }, 5000);
    </script>
  </body>
</html>